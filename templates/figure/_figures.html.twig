{# templates/figure/_figures.html.twig #}

{% for figure in figures %}
	<div class="col-md-4 mb-4">

		<div class="card">
			<a href="{{ path('app_figure_show', {'slug': figure.slug}) }}">
				{% if figure.images|length > 0 %}
					<img src="{{ asset('uploads/images/' ~ figure.images[0].getImageName()) }}" class="card-img-top" alt="{{ figure.name }}">
				{% else %}
					<img src="{{ asset('uploads/images/default.png') }}" class="card-img-top" alt="{{ figure.name }}">
				{% endif %}
				<div class="card-body">
					<h5 class="card-title">{{ figure.name }}</h5>
					<a href="{{ path('app_figure_edit', {'slug': figure.slug}) }}" class="btn btn-primary">
						<i class="bi bi-pencil"></i>
					</a>
					<button class="btn btn-danger" type="submit" form="delete-form-{{ figure.id }}">
						<i class="fas fa-trash-alt"></i>
					</button>
					<form method="post" action="{{ path('app_figure_delete', {'id': figure.id}) }}" onsubmit="return confirm('êtes-vous sûr de vouloir supprimer cette figure?');" id="delete-form-{{ figure.id }}">
						<input type="hidden" name="_token" value="{{ csrf_token('delete' ~ figure.id) }}">
					</form>
					<hr><h6>Comments:</h6>
					<ul class="list-unstyled">
                    {% for comment in figure.comments %}
                    {% if comment.user.avatar %}
						<img src="{{comment.user.avatar.imageURL}}" class="mr-3" alt="Avatar" style="width:100px;height:100px;">
                        {% endif %}
						<divclass="media-body">
							<h6 class="mt-0mb-1">{{comment.user.fullName}}</h6>
							<p>{{comment.content}}</p>
							<small class="text-muted">{{comment.createdAt|date('d/m/YH:i')}}</small>
						</div>
					</li>
                    {% endfor %}
				</ul>
			</div>
		</div>
	</div>
{% endfor %}
